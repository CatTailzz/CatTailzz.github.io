## MAE探索过程

实验条件说明：我们使用的数据集是ImageNet，攻击工具使用了集成的AutoAttack，攻击模型统一采用APGD-CE，加噪限制为Linf=8/255，攻击的模型和评估模型都是BEiT，经过测试它对正常样本的分类准确率为80%。在mask方面，我们遵从MAE的标准，每个样本的大小resize为224\*224，每个petch的大小为16\*16。在热力图方面，我们使用LayerCAM的计算方式。

众所周知，Diffusion已经成为了对抗净化方法事实上的标准，作为对比方法，我们测试了它的净化能力，我们使用Guided-diffusion，并在反向扩散前分别添加了25%和50%的随机噪声，测试它的净化率作为我们的实验基准，在反向扩散前添加25%的随机噪声最高表现出了66.51%的净化率。

基于我们对MAE在净化方面能力的猜测，我们需要探索一种特殊的MASK策略，尽可能遮盖对抗噪声集中的位置，又要保留足够的特征位置以不影响MAE的重构能力。

我们首先希望验证MASK比例对于重构能力的影响，因此我们测试了MAE在不同mask比例情况下的重构能力，得到的结论是mask的比例越小重构的越好，这也和符合直觉。

接着我们引入对抗攻击和attention mask，逐步提升对抗区域的mask面积，虽然随着mask比例的提升净化率也跟着提升，但总体的净化率维持在20%-30%的低水平，我们猜测是因为attention区域在样本中总是相邻出现，因此我们总是mask掉一大片连续区域，完全遮盖了图像的关键特征部分，不符合原始mask策略的随机性需求。

为了验证随机性选择mask petch的重要性，我们再次修改了实验条件，保留对抗攻击的引入，但不再根据attention区域选择mask petch，而是按不同比例随机选择区域进行mask，整体的净化率由了明显的提升，但仍然维持在45%的水平。

随后我们还希望验证我们的假设：能影响分类器的分类结果的对抗噪声总是集中在前景部分，即与图像标签高度符合的区域，而在样本的背景区域则只有不那么重要的对抗噪声。因此我们反过来mask背景区域，得到的净化率很不理想，这也一定程度上验证了我们的假设。

基于之前的实验探索和假设验证，我们得到了mask的几点需求：1.整体mask比例需要达到50%以上，以遮盖足够面积的对抗petch。2.对抗petch总是集中在样本的前景，并且总是连续出现。3.mask的petch尽量不相邻，避免一整片区域都被mask，这会使MAE失去正常的重构能力。我们最后提出了多生成图组合的策略，针对对抗petch总是连续出现，而一次mask掉他们又会使MAE无法正常重构的问题，我们提出分批mask的策略，将对抗petch分配到多次重构中，每次mask不连续的小部分对抗petch并重构，将结果图加权平均进行重组，另外为了保证mask的比例，我们还为每个mask补充随机的背景部分。在具体的实验实施上，我们验证了不同的mask比例和分批数的组合策略，最后达到了60.52%的净化率。

虽然目前我们的净化率尚未超越Diffusion模型的水准，但差距已经不大，并且在推理速度和模型成本上已经完成超越。我们认为，通过进一步优化mask策略或调整MAE参数，我们的基于Transformer的方法有很大的提升潜力。我们相信Transformer架构在特征学习方面的优势，期待其他研究者能够在此基础上，继续推进对抗净化等下游任务的研究。